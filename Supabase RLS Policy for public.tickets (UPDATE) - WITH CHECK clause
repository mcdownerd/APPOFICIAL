(
    -- Admin pode sempre atualizar qualquer linha
    EXISTS (
        SELECT 1
        FROM profiles
        WHERE
            profiles.id = auth.uid()
            AND profiles.user_role = 'admin'::text
    )
)
OR
(
    -- Restaurante pode atualizar se:
    -- 1. O utilizador autenticado tem o papel de 'restaurante'
    EXISTS (
        SELECT 1
        FROM profiles
        WHERE
            profiles.id = auth.uid()
            AND profiles.user_role = 'restaurante'::text
            AND profiles.restaurant_id = NEW.restaurant_id -- Comparação direta com NEW.restaurant_id dentro do EXISTS
    )
)