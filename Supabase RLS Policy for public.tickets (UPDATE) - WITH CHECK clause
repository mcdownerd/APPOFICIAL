(
    -- Admin pode sempre atualizar qualquer linha
    (SELECT user_role FROM profiles WHERE id = auth.uid()) = 'admin'::text
)
OR
(
    -- Restaurante pode atualizar se:
    -- 1. O utilizador autenticado tem o papel de 'restaurante'
    (SELECT user_role FROM profiles WHERE id = auth.uid()) = 'restaurante'::text
    AND
    -- 2. O restaurant_id da NOVA linha (NEW.restaurant_id) corresponde ao restaurant_id do utilizador
    NEW.restaurant_id = (SELECT restaurant_id FROM profiles WHERE id = auth.uid())
)