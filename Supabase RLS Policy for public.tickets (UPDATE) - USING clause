(
    (
        EXISTS (
            SELECT 1
            FROM profiles
            WHERE
                (profiles.id = auth.uid())
                AND (profiles.user_role = 'restaurante'::text)
                AND (profiles.restaurant_id = tickets.restaurant_id)
        )
        AND (tickets.soft_deleted = FALSE)
    )
    OR
    (
        EXISTS (
            SELECT 1
            FROM profiles
            WHERE
                (profiles.id = auth.uid())
                AND (profiles.user_role = 'admin'::text)
        )
    )
)